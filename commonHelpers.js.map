{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["// https://pixabay.com/api/?key=44530588-77e4763ebb7280f93ce94dd82&q=yellow+flowers&image_type=photo\n\nconst BASE_URL = 'https://pixabay.com/api/?';\nconst KEY = 'key=44530588-77e4763ebb7280f93ce94dd82';\nconst options = {\n  // headers: {\n  //   'Key': 'key=44530588-77e4763ebb7280f93ce94dd82',\n  \n  // },\n};\n\nexport class NewsAPI {\n  query = '';\n  #pageSize = 10;\n  page = 1;\n  total_pages = 1;\n\n  getArticles() {\n    const PARAMS = new URLSearchParams({\n      q: this.query,\n      page_size: this.#pageSize,\n      page: this.page,\n    });\n\n    // const url = `${BASE_URL}${KEY}${PARAMS}`;\n    const url =  'https://pixabay.com/api/?key=44530588-77e4763ebb7280f93ce94dd82&q=yellow+flowers&image_type=photo';\n    console.log(url);\n    return fetch(url, options).then(res => res.json());\n  }\n\n  get pageSize() {\n    return this.#pageSize;\n  }\n}","// key = 44530588-77e4763ebb7280f93ce94dd82\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { NewsAPI } from '/js/pixabay-api';\n\nconst refs = {\n  formElem: document.querySelector('.js-search-form'),\n  articleListElem: document.querySelector('.js-article-list'),\n  btnLoadMore: document.querySelector('.js-btn-load'),\n  loadElem: document.querySelector('.js-loader'),\n};\n\nconst newsApi = new NewsAPI();\n\n// ==========================================\nrefs.formElem.addEventListener('submit', onFormSubmit);\n\nasync function onFormSubmit(e) {\n\n  console.log(\"submit ok\");\n\n  e.preventDefault();\n  showSpinner();\n\n  const query = e.target.elements.query.value.trim();\n  newsApi.page = 1;\n  newsApi.query = query;\n  // refs.articleListElem.innerHTML = '';\n  try {\n    const data = await newsApi.getArticles();\n    console.log(data);\n    newsApi.totalResult = data.totalResults;\n    renderArticles(data.hits);\n  } catch (err) {\n    newsApi.totalResult = 0;\n    iziToast.error({\n      title: 'Error',\n      message: err.message,\n    });\n  }\n\n  checkBtnStatus();\n  hideSpinner();\n}\n// ==========================================\n\n// refs.btnLoadMore.addEventListener('click', onLoadMoreClick);\n\n// async function onLoadMoreClick() {\n//   showSpinner();\n//   newsApi.page += 1;\n//   const data = await newsApi.getArticles();\n//   renderArticles(data.articles);\n//   checkBtnStatus();\n//   hideSpinner();\n// }\n\n// ==========================================\nfunction articleTemplate(article) {\n  const { userImageURL,likes} = article;\n  return `<li class=\"card news-card\">\n  <img loading=\"lazy\"\n    class=\"news-image\"\n    src=\"${userImageURL}\"\n    alt=\"\"\n  />\n  <h3 class=\"card-title\">\n    ${likes}\n  </h3>\n  // <p class=\"card-desc\">\n  // ${likes}\n  // </p>\n  // <div class=\"card-footer\">\n  //   <span>${likes}</span>\n  //   <span>${likes}</span>\n  // </div>\n</li>\n`;\n}\n\nfunction articlesTemplate(articles) {\n  return articles.map(articleTemplate).join('');\n}\n\nfunction renderArticles(articles) {\n  const markup = articlesTemplate(articles);\n  refs.articleListElem.insertAdjacentHTML('beforeend', markup);\n}\n// ==========================================\n\n/* function checkBtnStatus() {\n  const maxPage = Math.ceil(newsApi.totalResult / NewsAPI.PAGE_SIZE);\n  const isLastPage = maxPage === newsApi.page;\n  refs.btnLoadMore.disabled = isLastPage;\n} */\n\nfunction checkBtnStatus() {\n  console.log(newsApi.totalResult);\n  console.log(newsApi.page);\n  const maxPage = Math.ceil(newsApi.totalResult / NewsAPI.PAGE_SIZE);\n  const isLastPage = maxPage <= newsApi.page;\n  if (isLastPage) {\n    refs.btnLoadMore.classList.add('hidden');\n  } else {\n    // refs.btnLoadMore.classList.remove('hidden');\n  }\n}\n\n// =======================\n\nfunction showSpinner() {\n  // refs.loadElem.classList.remove('hidden');\n  // refs.btnLoadMore.classList.add('hidden');\n}\n\nfunction hideSpinner() {\n  // refs.loadElem.classList.add('hidden');\n  // refs.btnLoadMore.classList.remove('hidden');\n}"],"names":["options","NewsAPI","__publicField","__privateAdd","_pageSize","__privateGet","url","res","refs","newsApi","onFormSubmit","e","query","data","renderArticles","err","iziToast","checkBtnStatus","articleTemplate","article","userImageURL","likes","articlesTemplate","articles","markup"],"mappings":"mqCAIA,MAAMA,EAAU,CAKhB,QAEO,MAAMC,CAAQ,CAAd,cACLC,EAAA,aAAQ,IACRC,EAAA,KAAAC,EAAY,IACZF,EAAA,YAAO,GACPA,EAAA,mBAAc,GAEd,aAAc,CACG,IAAI,gBAAgB,CACjC,EAAG,KAAK,MACR,UAAWG,EAAA,KAAKD,GAChB,KAAM,KAAK,IACjB,CAAK,EAGD,MAAME,EAAO,oGACb,eAAQ,IAAIA,CAAG,EACR,MAAMA,EAAKN,CAAO,EAAE,KAAKO,GAAOA,EAAI,KAAI,CAAE,CAClD,CAED,IAAI,UAAW,CACb,OAAOF,EAAA,KAAKD,EACb,CACH,CApBEA,EAAA,YCRF,MAAMI,EAAO,CACX,SAAU,SAAS,cAAc,iBAAiB,EAClD,gBAAiB,SAAS,cAAc,kBAAkB,EAC1D,YAAa,SAAS,cAAc,cAAc,EAClD,SAAU,SAAS,cAAc,YAAY,CAC/C,EAEMC,EAAU,IAAIR,EAGpBO,EAAK,SAAS,iBAAiB,SAAUE,CAAY,EAErD,eAAeA,EAAaC,EAAG,CAE7B,QAAQ,IAAI,WAAW,EAEvBA,EAAE,eAAc,EAGhB,MAAMC,EAAQD,EAAE,OAAO,SAAS,MAAM,MAAM,OAC5CF,EAAQ,KAAO,EACfA,EAAQ,MAAQG,EAEhB,GAAI,CACF,MAAMC,EAAO,MAAMJ,EAAQ,cAC3B,QAAQ,IAAII,CAAI,EAChBJ,EAAQ,YAAcI,EAAK,aAC3BC,EAAeD,EAAK,IAAI,CACzB,OAAQE,EAAK,CACZN,EAAQ,YAAc,EACtBO,EAAS,MAAM,CACb,MAAO,QACP,QAASD,EAAI,OACnB,CAAK,CACF,CAEDE,GAEF,CAeA,SAASC,EAAgBC,EAAS,CAChC,KAAM,CAAE,aAAAC,EAAa,MAAAC,CAAK,EAAIF,EAC9B,MAAO;AAAA;AAAA;AAAA,WAGEC,CAAY;AAAA;AAAA;AAAA;AAAA,MAIjBC,CAAK;AAAA;AAAA;AAAA,OAGJA,CAAK;AAAA;AAAA;AAAA,eAGGA,CAAK;AAAA,eACLA,CAAK;AAAA;AAAA;AAAA,CAIpB,CAEA,SAASC,EAAiBC,EAAU,CAClC,OAAOA,EAAS,IAAIL,CAAe,EAAE,KAAK,EAAE,CAC9C,CAEA,SAASJ,EAAeS,EAAU,CAChC,MAAMC,EAASF,EAAiBC,CAAQ,EACxCf,EAAK,gBAAgB,mBAAmB,YAAagB,CAAM,CAC7D,CASA,SAASP,GAAiB,CACxB,QAAQ,IAAIR,EAAQ,WAAW,EAC/B,QAAQ,IAAIA,EAAQ,IAAI,EACR,KAAK,KAAKA,EAAQ,YAAcR,EAAQ,SAAS,GACnCQ,EAAQ,MAEpCD,EAAK,YAAY,UAAU,IAAI,QAAQ,CAI3C"}